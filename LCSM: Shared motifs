# -*- coding: utf-8 -*-
"""
Created on Tue May 21 16:41:09 2019

@author: Alma
"""

#V1
import itertools

#append ids and multi-line sequences to their respective lists
ids = []
sequences=[]
with open('rosalind_lcsm (1).txt') as file_object:
    sequence = ''
    for line in file_object:
        if ('>') not in line:
            sequence	+=	line.rstrip('\n')
            continue
        else:
            ids.append(line.rstrip('\n').lstrip('>'))
            if sequence:
                sequences.append(sequence)
                sequence = ""
    sequences.append(sequence)
#print(ids)
#print(sequences)
#find the shortest string in the list of sequences
shortest = min(sequences, key=len)
#print(shortest)

substrings = []
def all_substrings(string):
    """finds all the substrings, appends to list"""

    last_index = len(string)
    for i in range(0,last_index):
        for j in range((i+1),(last_index+1)):
            substring=shortest[i:j]
            substrings.append(substring)

   # print(substrings)
    
all_substrings(shortest)
#find the longest of the substrings
longest_sub = max(substrings, key=len)
#print(longest_sub)
  
in_all =[]
#for sub in subs:
for sub in substrings:
    contains =[]
    for seq in sequences:
        if sub in seq:
#if the substring's in the superstring, append a truthy value to 
            contains.append(1)
        else:
            contains.append(0)
#if the substring's in all the superstrings, append it to the strs list
    if all(contains):
        in_all.append(sub)
#print(in_all)
#return the longest substring in that list
longest_motif = max(in_all, key=len)
print(longest_motif)
